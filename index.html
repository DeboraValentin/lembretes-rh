<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Lembretes de RH - Aniversariantes do Mês</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #34495e;
            --success: #2ecc71;
            --warning: #f39c12;
            --professional: #9b59b6;
            --birthday: #e67e22;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--dark) 100%);
            color: white;
            padding: 25px 0;
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .instructions {
            background: var(--light);
            padding: 20px;
            border-bottom: 1px solid #ddd;
        }

        .instructions h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .instructions ol {
            margin-left: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            padding: 20px;
        }

        .card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.3rem;
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
            display: flex;
            align-items: center;
        }

        .card-title i {
            margin-right: 10px;
        }

        .today-events {
            background: linear-gradient(135deg, #4ca1af 0%, #c4e0e5 100%);
            color: white;
        }

        .today-events .card-title {
            color: white;
            border-bottom-color: rgba(255, 255, 255, 0.3);
        }

        .event-list {
            list-style: none;
        }

        .event-item {
            padding: 12px;
            margin-bottom: 10px;
            background: var(--light);
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .event-profession {
            font-weight: bold;
            color: var(--dark);
        }

        .event-date {
            color: var(--secondary);
            font-size: 0.9rem;
        }

        .upcoming-events {
            margin-top: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--dark);
        }

        input,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
        }

        button {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        button i {
            margin-right: 8px;
        }

        button:hover {
            background: var(--primary);
        }

        .actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn-secondary {
            background: #95a5a6;
        }

        .btn-danger {
            background: var(--accent);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-professional {
            background: var(--professional);
        }

        .btn-birthday {
            background: var(--birthday);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th,
        td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: var(--light);
            font-weight: 600;
            color: var(--dark);
        }

        tr:hover {
            background-color: rgba(52, 152, 219, 0.05);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: var(--success);
            color: white;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            max-width: 400px;
        }

        .notification i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification.error {
            background: var(--accent);
        }

        .notification.warning {
            background: var(--warning);
        }

        .notification.professional {
            background: var(--professional);
        }

        .event-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-left: 8px;
            color: white;
        }

        .badge-profession {
            background: var(--professional);
        }

        .badge-birthday {
            background: var(--birthday);
        }

        .filter-active {
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.2);
        }

        .empty-state {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-style: italic;
        }

        .profession-date {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .month-birthdays {
            margin-top: 20px;
        }

        .birthday-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: #fff8e1;
            border-radius: 6px;
            border-left: 4px solid var(--birthday);
        }

        .birthday-date {
            font-weight: bold;
            color: var(--dark);
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }

            .actions {
                flex-direction: column;
            }

            button {
                width: 100%;
            }

            .notification {
                max-width: 300px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>Sistema de Lembretes de RH</h1>
            <p class="subtitle">Com aniversariantes do mês</p>
        </header>
        <div class="instructions">
            <h3>Como usar este aplicativo:</h3>
            <ol>
                <li>Preencha o formulário à esquerda para adicionar lembretes</li>
                <li>Selecione a profissão para usar a data comemorativa padrão ou informe uma data personalizada</li>
                <li>Use os botões de filtro para visualizar eventos específicos</li>
                <li>Seus dados são salvos localmente no navegador</li>
                <li>O sistema notificará automaticamente sobre datas profissionais e aniversários</li>
            </ol>
        </div>
        <div class="dashboard">
            <div>
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-plus-circle"></i> Adicionar Lembrete</h2>
                    <div class="form-group">
                        <label for="name">Nome do Profissional:</label>
                        <input type="text" id="name" placeholder="Digite o nome">
                    </div>
                    <div class="form-group">
                        <label for="profession">Profissão:</label>
                        <select id="profession">
                            <option value="">Selecione uma profissão</option>
                            <option value="Assistente Social">Assistente Social (15/05)</option>
                            <option value="Agente Administrativo">Agente Administrativo (04/05)</option>
                            <option value="Agente de Conservação">Agente de Conservação (16/05)</option>
                            <option value="Ajudante Geral">Ajudante Geral (16/05)</option>
                            <option value="Analista Administrativo">Analista Administrativo (04/05)</option>
                            <option value="Comissionados">Comissionados</option>
                            <option value="Cozinheira">Cozinheira (25/08)</option>
                            <option value="Cuidador">Cuidador (20/01)</option>
                            <option value="Educador Social">Educador Social (19/09)</option>
                            <option value="Motorista">Motorista (25/07)</option>
                            <option value="Nutricionista">Nutricionista (31/08)</option>
                            <option value="Pedagogo">Pedagogo (20/05)</option>
                            <option value="Psicólogo">Psicólogo (27/08)</option>
                            <option value="Estagiário">Estagiário (18/08)</option>
                            <option value="other">Outra profissão</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="date">Data de Comemoração:</label>
                        <input type="date" id="date">
                    </div>
                    <div class="form-group">
                        <label for="type">Tipo de Evento:</label>
                        <select id="type">
                            <option value="profession">Data Profissional</option>
                            <option value="birthday">Aniversário</option>
                        </select>
                    </div>
                    <button id="add-btn"><i class="fas fa-plus"></i> Adicionar Lembrete</button>
                </div>
                <div class="card today-events">
                    <h2 class="card-title"><i class="fas fa-calendar-day"></i> Próximos Eventos</h2>
                    <div id="upcoming-container">
                        <ul class="event-list" id="upcoming-events">
                            <!-- Será preenchido via JavaScript -->
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-birthday-cake"></i> Aniversariantes do Mês</h2>
                    <div id="month-birthdays">
                        <!-- Será preenchido via JavaScript -->
                    </div>
                </div>
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-database"></i> Gerenciar Dados</h2>
                    <div class="actions">
                        <button class="btn-success" id="export-btn"><i class="fas fa-file-export"></i> Exportar Dados</button>
                        <button class="btn-secondary" id="import-btn"><i class="fas fa-file-import"></i> Importar Dados</button>
                        <button class="btn-secondary" id="import-excel-btn"><i class="fas fa-file-excel"></i> Importar Excel</button>
                        <button class="btn-danger" id="clear-btn"><i class="fas fa-trash"></i> Limpar Tudo</button>
                    </div>
                </div>
            </div>
            <div>
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-list"></i> Todos os Lembretes</h2>
                    <div class="actions">
                        <button id="all-btn" class="filter-active"><i class="fas fa-eye"></i> Ver Todos</button>
                        <button id="today-btn" class="btn-secondary"><i class="fas fa-calendar-day"></i> Hoje</button>
                        <button id="professional-btn" class="btn-professional"><i class="fas fa-briefcase"></i> Profissionais</button>
                        <button id="birthday-btn" class="btn-birthday"><i class="fas fa-birthday-cake"></i> Aniversários</button>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Profissão/Evento</th>
                                <th>Data</th>
                                <th>Tipo</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="reminders-list">
                            <!-- Será preenchido via JavaScript -->
                        </tbody>
                    </table>
                </div>
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-info-circle"></i> Datas Profissionais Cadastradas</h2>
                    <p>O sistema notificará automaticamente sobre estas datas:</p>
                    <div id="professional-dates-list">
                        <div class="profession-date">
                            <span class="event-profession">Assistente Social</span>
                            <span class="event-date">15 de Maio</span>
                        </div>
                        <div class="profession-date">
                            <span class="event-profession">Agente Administrativo</span>
                            <span class="event-date">4 de Maio</span>
                        </div>
                        <div class="profession-date">
                            <span class="event-profession">Cozinheira</span>
                            <span class="event-date">25 de Agosto</span>
                        </div>
                        <div class="profession-date">
                            <span class="event-profession">Educador Social</span>
                            <span class="event-date">19 de Setembro</span>
                        </div>
                        <div class="profession-date">
                            <span class="event-profession">Estagiário</span>
                            <span class="event-date">18 de Agosto</span>
                        </div>
                        <div class="profession-date">
                            <span class="event-profession">Motorista</span>
                            <span class="event-date">25 de Julho</span>
                        </div>
                        <div class="profession-date">
                            <span class="event-profession">Psicólogo</span>
                            <span class="event-date">27 de Agosto</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">Lembrete adicionado com sucesso!</span>
    </div>
    <input type="file" id="import-file" style="display: none;" accept=".json">
    <input type="file" id="import-excel" style="display: none;" accept=".xlsx,.xls">
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const addButton = document.getElementById('add-btn');
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            const importFile = document.getElementById('import-file');
            const importExcel = document.getElementById('import-excel');
            let reminders = [];
            let currentFilter = 'all';

            // Datas profissionais fixas
            const professionalDates = {
                'Assistente Social': '05-15',
                'Agente Administrativo': '05-04',
                'Agente de Conservação': '05-16',
                'Ajudante Geral': '05-16',
                'Analista Administrativo': '05-04',
                'Cozinheira': '08-25',
                'Cuidador': '01-20',
                'Educador Social': '09-19',
                'Motorista': '07-25',
                'Nutricionista': '08-31',
                'Pedagogo': '05-20',
                'Psicólogo': '08-27',
                'Estagiário': '08-18'
            };

            // Carregar lembretes do localStorage
            function loadReminders() {
                const saved = localStorage.getItem('rh-reminders');
                if (saved) {
                    reminders = JSON.parse(saved);
                    renderReminders();
                    checkUpcomingEvents();
                    showMonthBirthdays();
                }
            }

            // Salvar lembretes no localStorage
            function saveReminders() {
                localStorage.setItem('rh-reminders', JSON.stringify(reminders));
            }

            // Função corrigida para lidar com datas - considera o fuso horário local
            function parseDate(input) {
                // Se já é um objeto Date, retorna como está
                if (input instanceof Date) return input;

                // Se está no formato ISO (YYYY-MM-DD)
                if (typeof input === 'string' && input.includes('-')) {
                    const parts = input.split('-');
                    if (parts.length === 3) {
                        // new Date(ano, mês-1, dia) usa o fuso horário local
                        return new Date(parts[0], parts[1] - 1, parts[2]);
                    }
                }

                // Se está no formato DD/MM/YYYY ou similar
                if (typeof input === 'string' && input.includes('/')) {
                    const parts = input.split('/');
                    if (parts.length === 3) {
                        return new Date(parts[2], parts[1] - 1, parts[0]);
                    }
                }

                // Fallback para o construtor padrão de Date
                return new Date(input);
            }

            // Formatar data para exibição (DD/MM/AAAA)
            function formatDate(dateString) {
                const date = parseDate(dateString);
                if (isNaN(date.getTime())) return 'Data inválida';
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const year = date.getFullYear();
                return `${day}/${month}/${year}`;
            }

            // Formatar data para exibição sem o ano (DD/MM)
            function formatDateWithoutYear(dateString) {
                const date = parseDate(dateString);
                if (isNaN(date.getTime())) return 'Data inválida';
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                return `${day}/${month}`;
            }

            // Converter data para formato YYYY-MM-DD para input date
            function formatDateForInput(dateString) {
                const date = parseDate(dateString);
                if (isNaN(date.getTime())) return '';
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            }

            // Comparar duas datas (ignorando o horário)
            function isSameDate(date1, date2) {
                const d1 = parseDate(date1);
                const d2 = parseDate(date2);
                return d1.getFullYear() === d2.getFullYear() &&
                    d1.getMonth() === d2.getMonth() &&
                    d1.getDate() === d2.getDate();
            }

            // Verificar se duas datas são no mesmo mês
            function isSameMonth(date1, date2) {
                const d1 = parseDate(date1);
                const d2 = parseDate(date2);
                return d1.getFullYear() === d2.getFullYear() &&
                    d1.getMonth() === d2.getMonth();
            }

            // Renderizar a lista de lembretes com filtro
            function renderReminders() {
                const tbody = document.getElementById('reminders-list');
                tbody.innerHTML = '';
                let filteredReminders = reminders;

                // Aplicar filtro
                if (currentFilter === 'today') {
                    const today = new Date();
                    filteredReminders = reminders.filter(r => isSameDate(r.date, today));
                } else if (currentFilter === 'professional') {
                    filteredReminders = reminders.filter(r => r.type === 'profession');
                } else if (currentFilter === 'birthday') {
                    filteredReminders = reminders.filter(r => r.type === 'birthday');
                }

                if (filteredReminders.length === 0) {
                    const emptyRow = document.createElement('tr');
                    emptyRow.innerHTML = `<td colspan="5" class="empty-state">Nenhum lembrete encontrado</td>`;
                    tbody.appendChild(emptyRow);
                    return;
                }

                filteredReminders.forEach((reminder, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${reminder.name}</td>
                        <td>${reminder.type === 'birthday' ? 'Aniversário' : reminder.profession}</td>
                        <td>${formatDate(reminder.date)}</td>
                        <td><span class="event-badge ${reminder.type === 'birthday' ? 'badge-birthday' : 'badge-profession'}">${reminder.type === 'birthday' ? 'Aniversário' : 'Profissional'}</span></td>
                        <td>
                            <button class="btn-danger" onclick="deleteReminder(${reminders.indexOf(reminder)})"><i class="fas fa-trash"></i> Excluir</button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }

            // Verificar eventos próximos (próximos 7 dias)
            function checkUpcomingEvents() {
                const upcomingList = document.getElementById('upcoming-events');
                upcomingList.innerHTML = '';
                const today = new Date();
                const nextWeek = new Date();
                nextWeek.setDate(today.getDate() + 7);

                const upcomingEvents = reminders.filter(reminder => {
                    const eventDate = parseDate(reminder.date);
                    return eventDate >= today && eventDate <= nextWeek;
                });

                if (upcomingEvents.length === 0) {
                    upcomingList.innerHTML = '<div class="empty-state">Nenhum evento próximo</div>';
                    return;
                }

                // Ordenar por data
                upcomingEvents.sort((a, b) => parseDate(a.date) - parseDate(b.date));

                upcomingEvents.forEach(event => {
                    const eventItem = document.createElement('li');
                    eventItem.className = 'event-item';
                    const eventDate = parseDate(event.date);
                    const daysUntil = Math.ceil((eventDate - today) / (1000 * 60 * 60 * 24));
                    eventItem.innerHTML = `
                        <div>
                            <div class="event-profession">${event.type === 'birthday' ? 'Aniversário de ' + event.name : event.profession}</div>
                            <div class="event-date">${formatDate(event.date)} - ${daysUntil === 0 ? 'Hoje' : `Em ${daysUntil} dias`}</div>
                        </div>
                        <span class="event-badge ${event.type === 'birthday' ? 'badge-birthday' : 'badge-profession'}">${event.type === 'birthday' ? 'Aniversário' : 'Profissional'}</span>
                    `;
                    upcomingList.appendChild(eventItem);
                });
            }

            // Mostrar aniversariantes do mês
            function showMonthBirthdays() {
                const monthContainer = document.getElementById('month-birthdays');
                monthContainer.innerHTML = '';
                const today = new Date();
                const currentMonth = today.getMonth();
                const currentYear = today.getFullYear();

                // Filtrar aniversários do mês atual
                const monthBirthdays = reminders.filter(reminder => {
                    if (reminder.type !== 'birthday') return false;
                    const birthdayDate = parseDate(reminder.date);
                    return birthdayDate.getMonth() === currentMonth && birthdayDate.getFullYear() <= currentYear;
                });

                if (monthBirthdays.length === 0) {
                    monthContainer.innerHTML = '<div class="empty-state">Nenhum aniversariante este mês</div>';
                    return;
                }

                // Ordenar por dia do mês
                monthBirthdays.sort((a, b) => {
                    const dateA = parseDate(a.date);
                    const dateB = parseDate(b.date);
                    return dateA.getDate() - dateB.getDate();
                });

                monthBirthdays.forEach(birthday => {
                    const birthdayItem = document.createElement('div');
                    birthdayItem.className = 'birthday-item';
                    birthdayItem.innerHTML = `
                        <div>
                            <strong>${birthday.name}</strong>
                        </div>
                        <div class="birthday-date">
                            ${formatDateWithoutYear(birthday.date)}
                        </div>
                    `;
                    monthContainer.appendChild(birthdayItem);
                });
            }

            // Função para mostrar notificação
            function showNotification(message, isError = false, isWarning = false, isProfessional = false) {
                notificationText.textContent = message;
                notification.className = 'notification';
                if (isError) {
                    notification.classList.add('error');
                } else if (isWarning) {
                    notification.classList.add('warning');
                } else if (isProfessional) {
                    notification.classList.add('professional');
                }

                // Alterar ícone conforme o tipo de notificação
                const icon = notification.querySelector('i');
                if (isError) {
                    icon.className = 'fas fa-exclamation-circle';
                } else if (isWarning) {
                    icon.className = 'fas fa-birthday-cake';
                } else if (isProfessional) {
                    icon.className = 'fas fa-briefcase';
                } else {
                    icon.className = 'fas fa-check-circle';
                }

                notification.classList.add('show');
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 5000); // Notificações ficam visíveis por 5 segundos
            }

            // Verificar datas profissionais
            function checkProfessionalDates() {
                const today = new Date();
                const day = String(today.getDate()).padStart(2, '0');
                const month = String(today.getMonth() + 1).padStart(2, '0');
                const todayFormatted = `${month}-${day}`;

                // Verificar se hoje é dia de alguma profissão
                for (const [profession, date] of Object.entries(professionalDates)) {
                    if (date === todayFormatted) {
                        showNotification(`Hoje é o dia do(a) ${profession}! 🎉`, false, false, true);
                    }
                }
            }

            // Adicionar lembrete
            addButton.addEventListener('click', function() {
                const name = document.getElementById('name').value.trim();
                const profession = document.getElementById('profession').value;
                let date = document.getElementById('date').value;
                const type = document.getElementById('type').value;

                if (!name) {
                    showNotification('Por favor, informe o nome do profissional!', true);
                    return;
                }

                if (type === 'profession' && !profession) {
                    showNotification('Por favor, selecione uma profissão!', true);
                    return;
                }

                if (!date) {
                    if (type === 'profession') {
                        // Se for uma profissão conhecida, usar a data padrão
                        const today = new Date();
                        let year = today.getFullYear();
                        if (professionalDates[profession]) {
                            date = `${year}-${professionalDates[profession]}`;
                        } else {
                            showNotification('Por favor, selecione uma data!', true);
                            return;
                        }
                    } else {
                        showNotification('Por favor, selecione uma data!', true);
                        return;
                    }
                }

                // Adicionar à lista
                reminders.push({
                    name,
                    profession: type === 'birthday' ? '' : profession,
                    date, // Armazenamos a data no formato YYYY-MM-DD
                    type
                });

                // Salvar e renderizar
                saveReminders();
                renderReminders();
                checkUpcomingEvents();
                showMonthBirthdays();

                // Limpar o formulário
                document.getElementById('name').value = '';
                document.getElementById('profession').value = '';
                document.getElementById('date').value = '';
                document.getElementById('type').value = 'profession';

                showNotification('Lembrete adicionado com sucesso!');
            });

            // Configurar filtros
            function setupFilterButtons() {
                const filterButtons = [
                    { id: 'all-btn', filter: 'all' },
                    { id: 'today-btn', filter: 'today' },
                    { id: 'professional-btn', filter: 'professional' },
                    { id: 'birthday-btn', filter: 'birthday' }
                ];

                filterButtons.forEach(btn => {
                    document.getElementById(btn.id).addEventListener('click', function() {
                        currentFilter = btn.filter;
                        renderReminders();

                        // Atualizar estado visual dos botões
                        filterButtons.forEach(b => {
                            const buttonEl = document.getElementById(b.id);
                            if (b.id === btn.id) {
                                buttonEl.classList.add('filter-active');
                            } else {
                                buttonEl.classList.remove('filter-active');
                            }
                        });
                    });
                });
            }

            // Limpar tudo
            document.getElementById('clear-btn').addEventListener('click', function() {
                if (confirm('Tem certeza que deseja limpar todos os lembretes? Esta ação não pode ser desfeita.')) {
                    reminders = [];
                    saveReminders();
                    renderReminders();
                    checkUpcomingEvents();
                    showMonthBirthdays();
                    showNotification('Todos os lembretes foram removidos!');
                }
            });

            // Exportar dados
            document.getElementById('export-btn').addEventListener('click', function() {
                const dataStr = JSON.stringify(reminders, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
                const exportFileDefaultName = 'lembretes-rh.json';
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                showNotification('Dados exportados com sucesso!');
            });

            // Importar dados JSON
            document.getElementById('import-btn').addEventListener('click', function() {
                importFile.click();
            });

            importFile.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        if (Array.isArray(importedData)) {
                            reminders = importedData;
                            saveReminders();
                            renderReminders();
                            checkUpcomingEvents();
                            showMonthBirthdays();
                            showNotification('Dados importados com sucesso!');
                        } else {
                            showNotification('Formato de arquivo inválido!', true);
                        }
                    } catch (error) {
                        showNotification('Erro ao importar arquivo!', true);
                    }
                };
                reader.readAsText(file);
                // Resetar o input de arquivo
                event.target.value = '';
            });

            // Importar Excel
            document.getElementById('import-excel-btn').addEventListener('click', function() {
                importExcel.click();
            });

            importExcel.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = e.target.result;
                        const workbook = XLSX.read(data, { type: 'binary', cellDates: true });
                        let importedCount = 0;

                        workbook.SheetNames.forEach(sheetName => {
                            const sheet = workbook.Sheets[sheetName];
                            const rows = XLSX.utils.sheet_to_json(sheet, { header: 1, defval: '' });

                            rows.forEach((row, rowIndex) => {
                                if (rowIndex === 0) return; // Pular cabeçalho, assumindo que a primeira linha é cabeçalho
                                const name = row[0] ? row[0].trim() : '';
                                let birthdate = row[1];

                                if (!name || !birthdate) return;

                                // Se birthdate for Date, converter para YYYY-MM-DD
                                if (birthdate instanceof Date) {
                                    const year = birthdate.getFullYear();
                                    const month = String(birthdate.getMonth() + 1).padStart(2, '0');
                                    const day = String(birthdate.getDate()).padStart(2, '0');
                                    birthdate = `${year}-${month}-${day}`;
                                } else if (typeof birthdate === 'string') {
                                    // Tentar parsear string DD/MM/YYYY ou similar
                                    birthdate = formatDateForInput(birthdate);
                                }

                                if (birthdate && birthdate !== '') {
                                    // Adicionar como aniversário
                                    reminders.push({
                                        name,
                                        profession: '',
                                        date: birthdate,
                                        type: 'birthday'
                                    });
                                    importedCount++;
                                }
                            });
                        });

                        if (importedCount > 0) {
                            saveReminders();
                            renderReminders();
                            checkUpcomingEvents();
                            showMonthBirthdays();
                            showNotification(`${importedCount} aniversários importados com sucesso!`);
                        } else {
                            showNotification('Nenhum dado válido encontrado no Excel!', true);
                        }
                    } catch (error) {
                        showNotification('Erro ao importar Excel!', true);
                    }
                };
                reader.readAsBinaryString(file);
                // Resetar o input de arquivo
                event.target.value = '';
            });

            // Verificar eventos diários
            function checkDailyEvents() {
                const today = new Date();

                // Verificar aniversários
                const todayBirthdays = reminders.filter(r => {
                    return r.type === 'birthday' && isSameDate(r.date, today);
                });

                todayBirthdays.forEach(birthday => {
                    showNotification(`Hoje é aniversário de ${birthday.name}! 🎂`, false, true);
                });

                // Verificar datas profissionais
                checkProfessionalDates();
            }

            // Inicializar a aplicação
            loadReminders();
            setupFilterButtons();

            // Verificar eventos diários ao carregar a página
            setTimeout(checkDailyEvents, 1000);
        });

        // Função global para excluir lembretes
        function deleteReminder(index) {
            if (confirm('Tem certeza que deseja excluir este lembrete?')) {
                const reminders = JSON.parse(localStorage.getItem('rh-reminders') || '[]');
                if (index >= 0 && index < reminders.length) {
                    reminders.splice(index, 1);
                    localStorage.setItem('rh-reminders', JSON.stringify(reminders));
                    location.reload();
                }
            }
        }
    </script>
</body>

</html>